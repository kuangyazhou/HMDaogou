/*! build: Fri Jan 26 2018 11:31:30 GMT+0800 (中国标准时间) */
webpackJsonp([42],{1362:function(e,t){},1366:function(e,t,o){e.exports=o.p+"imgs/page-login-logo.png"},889:function(e,t,o){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){var t=e.auth;return t?{user:t.user,loginError:t.loginError}:{user:null}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),s=o(2),c=function(e){return e&&e.__esModule?e:{default:e}}(s),d=o(402),u=o(401),h=o(4),f=o(403);o(1366),o(1362);var m=function(e){function t(e){a(this,t);var o=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.state={visible:!1,isDisabled:!1,logging:!1,errorCode:""},o.closeNotification=o.closeNotification.bind(o),o.handleLoginByPhone=o.handleLoginByPhone.bind(o),o.handleGetCode=o.handleGetCode.bind(o),o.handleChange=o.handleChange.bind(o),o}return r(t,e),l(t,[{key:"componentWillMount",value:function(){if(-1!==window.location.href.indexOf("code")){var e=void 0;if((e=-1!==window.location.href.indexOf("&")?window.location.href.slice(window.location.href.indexOf("=")+1,window.location.href.indexOf("&")):window.location.href.slice(window.location.href.indexOf("=")+1,window.location.href.indexOf("#")))&&"0"!==e)switch(e){case"-99":this.setState({errorCode:"请填写验证码"});break;case"-98":this.setState({errorCode:"请填写手机号"});break;case"-97":this.setState({errorCode:"该手机号未登记，请联系管理员"});break;case"-96":this.setState({errorCode:"该手机号存在重复登记记录，请联系管理员"});break;case"-95":this.setState({errorCode:"系统参数异常，请联系管理员"});break;case"-93":this.setState({errorCode:"该用户职位信息读取失败，请联系管理员"});break;case"-92":this.setState({errorCode:"该用户门店信息读取失败，请联系管理员"});break;case"-91":this.setState({errorCode:"该用户工号信息读取失败，请联系管理员"});break;case"-90":this.setState({errorCode:"登陆失败，请联系管理员"});break;case"-1":this.setState({errorCode:"验证码错误"});break;case"-2":this.setState({errorCode:"验证码失效"});break;default:this.setState({errorCode:"未知错误，请联系管理员"})}else this.setState({logging:!1})}}},{key:"componentDidMount",value:function(){var e=(0,f.getViewportHeight)(),t=this.props;t.dispatch,t.params,document.querySelector(".hm-login-header").style.height=.45*e+"px",document.querySelector(".login-by-phone").style.height=.35*e+"px";var o=document.querySelector(".to-login");""===this.phone.value&&""===this.code.value&&o.setAttribute("disabled",!0)}},{key:"handleLoginByPhone",value:function(){this.setState({logging:!0,isDisabled:!0});var e=void 0;return!(!(e=-1!==window.location.href.indexOf("&")?window.location.href.slice(window.location.href.indexOf("=")+1,window.location.href.indexOf("&")):window.location.href.slice(window.location.href.indexOf("=")+1,window.location.href.indexOf("#")))||"0"===e)}},{key:"handleGetCode",value:function(e){var t=this,o=(this.props.dispatch,this.phone.value),a={method:"post",mode:"cors",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({mobile:o})};fetch(h.RESTFUL_SERVER+"/crm/bind/send_code.json",a).then(function(e){return e.json()}).then(function(e){var o=e.code;if(o&&0!==o)switch(o){case-99:t.setState({errorCode:"网络异常，请联系管理员"});break;case-98:t.setState({errorCode:"请填写手机号"});break;case-97:t.setState({errorCode:"该手机号未登记，请联系管理员"});break;case-96:t.setState({errorCode:"该手机号存在重复登记记录，请联系管理员"});break;case-1:t.setState({errorCode:"网络异常，请联系管理员"});break;case-2:case-3:t.setState({errorCode:"短信发送失败，请联系管理员"});break;case-4:t.setState({errorCode:"您今日获取验证码次数已达上限"});break;case-5:t.setState({errorCode:"短信发送失败，请联系管理员"});break;default:t.setState({errorCode:"未知错误，请联系管理员"})}}).catch(function(e){t.setState({errorCode:"err"})});var n=e.target;n.classList.add("disabled");var r=60;n.textContent=r+"秒后再次获取",n.setAttribute("disabled",!0);var i=setInterval(function(){r--,n.textContent=r+"秒后再次获取",0===r&&(clearInterval(i),n.textContent="发送验证码",n.removeAttribute("disabled"),n.classList.remove("disabled"))},1e3)}},{key:"handleChange",value:function(){var e=document.querySelector(".to-login");""!==this.phone.value&&""!==this.code.value?e.removeAttribute("disabled"):e.setAttribute("disabled",!0)}},{key:"closeNotification",value:function(e){this.setState({visible:!1,errorCode:""})}},{key:"render",value:function(){var e=this,t=this.props,o=(t.user,t.loginError,h.RESTFUL_SERVER+"/crm/bind/check_code.htm");return c.default.createElement("div",{className:"hm-login-container"},c.default.createElement("header",{className:"hm-login-header"},c.default.createElement("img",{src:"../imgs/login/page-login-logo.png",alt:""}),c.default.createElement("p",{className:"system-name"},"禾苗·导购助手")),c.default.createElement("form",{action:o,method:"POST",className:"login-by-phone",onSubmit:this.handleLoginByPhone},c.default.createElement("div",{className:"phone-wrapper"},c.default.createElement("label",{htmlFor:"phone"},c.default.createElement("i",{className:"iconfont icon-dianhua"})),c.default.createElement("input",{type:"tel",id:"phone",maxLength:"11",name:"mobile",onChange:this.handleChange,ref:function(t){e.phone=t}})),c.default.createElement("div",{className:"validate-code-wrapper"},c.default.createElement("label",{htmlFor:"code"},c.default.createElement("i",{className:"iconfont icon-ziyuan"})),c.default.createElement("input",{type:"tel",id:"code",name:"checkCode",maxLength:"6",onChange:this.handleChange,ref:function(t){e.code=t}}),c.default.createElement("button",{className:"send-code",onClick:this.handleGetCode},"获取验证码")),c.default.createElement(u.Button,{amSize:"xl",amStyle:"warning",type:"submit",className:"to-login",disabled:this.state.isDisabled,hollow:!0},"登     录",c.default.createElement(u.Loader,{className:this.state.logging?"":"hide",amStyle:"warning",rounded:!0}))),c.default.createElement(u.Notification,{title:"登录错误!",amStyle:"alert",visible:""!==this.state.errorCode,animated:!0,onDismiss:this.closeNotification},this.state.errorCode),c.default.createElement("ul",{className:"hm-top-circle"},c.default.createElement("li",{className:"first"}),c.default.createElement("li",{className:"second"}),c.default.createElement("li",{className:"third"}),c.default.createElement("li",{className:"fourth"}),c.default.createElement("li",{className:"fifth"}),c.default.createElement("li",{className:"sixth"}),c.default.createElement("li",{className:"seventh"}),c.default.createElement("li",{className:"eighth"}),c.default.createElement("li",{className:"ninth"}),c.default.createElement("li",{className:"tenth"})))}}]),t}(s.Component);m.contextTypes={router:s.PropTypes.object.isRequired,store:s.PropTypes.object.isRequired},m.propTypes={user:s.PropTypes.object,loginError:s.PropTypes.object,dispatch:s.PropTypes.func.isRequired,location:s.PropTypes.object},t.default=(0,d.connect)(i)(m)}});