/*! build: Fri Jan 26 2018 11:31:30 GMT+0800 (中国标准时间) */
webpackJsonp([21],{1071:function(e,t,n){var a,i,s;!function(l,r){i=[t,n(2),n(69)],a=r,void 0!==(s="function"==typeof a?a.apply(t,i):a)&&(e.exports=s)}(0,function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function i(e){return"function"==typeof e.children?e.children():e.children||null}function s(e){return i(e)}function l(e){return i(e)}function r(e){var t=e.children;return null==t?null:[].concat(t).find(function(t){return t.type!==l^!e.condition})||null}Object.defineProperty(e,"__esModule",{value:!0}),e.Then=s,e.Else=l,e.If=r;var o=(a(t),a(n));s.propTypes=l.propTypes={children:o.default.oneOfType([o.default.func,o.default.string,o.default.number,o.default.object])};var c=o.default.oneOfType([o.default.object,o.default.instanceOf(s),o.default.instanceOf(l)]);r.propTypes={condition:o.default.bool.isRequired,children:o.default.oneOfType([o.default.arrayOf(c),c])},r.Then=s,r.Else=l,e.default=r})},1420:function(e,t){},882:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e){return{marketing:e.marketing,error:e.error,sendCustomerCoupon:e.sendCustomerCoupon,sendCustomerMarketing:e.sendCustomerMarketing}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(2),u=a(c),d=n(402),f=n(1071),p=n(401),m=n(426),h=n(946),y=a(h);n(4),n(403),n(1420);var b=function(e){function t(e){i(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isErrorHappend:!1,isSuccess:!1,isEmpty:!1,isChecked:!1,isNotChecked:!1,isSubmit:!1,isReset:!0,isNotBind:!1,isSended:!1,isFailed:!1,isSubmitReason:!1,isReasonFailed:!1},n.handleCommitMarketing=n.handleCommitMarketing.bind(n),n.handleSpecifyMarketing=n.handleSpecifyMarketing.bind(n),n.closeNotification=n.closeNotification.bind(n),n.closeAlert=n.closeAlert.bind(n),n}return l(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.dispatch,n=(e.marketing,this.props.params),a=n.type,i=(n.phone,n.realname,n.offlineId);n.isBind,"memberMarketing"===a&&(t((0,m.fetchMarketingReasons)()),t((0,m.fetchMarketings)(i)))}},{key:"componentWillReceiveProps",value:function(e){var t=(this.props.sendCustomerCoupon,this.props.params),n=t.type;switch(t.phone,t.realname,t.offlineId,"notBind"===t.isBind&&"specifyMarketing"===n&&this.setState({isNotBind:!0,isSubmit:!0}),n){case"specifyMarketing":this.state.isSended&&e.sendCustomerCoupon.isSmsSended&&(0===e.sendCustomerCoupon.smsReturnCode?this.setState({isChecked:!0}):this.setState({isFailed:!0}));break;case"memberMarketing":this.state.isSubmitReason&&e.sendCustomerMarketing.isReasonFetching&&(0===e.sendCustomerMarketing.reasonCode?this.setState({isSuccess:!0}):this.setState({isReasonFailed:!0}))}}},{key:"handleCommitMarketing",value:function(e){e.preventDefault();var t=this.props.dispatch,n=this.props.params.offlineId,a=this.noteForMarketing.value,i=this.selectedReason.getSelectedOptions();this.setState({isSubmit:!0,isSubmitReason:!0}),this.noteForMarketing.value="",t((0,m.postAddMarketing)(n,a,i))}},{key:"handleSpecifyMarketing",value:function(e){e.preventDefault();var t=this.props,n=t.dispatch,a=(t.sendCustomerCoupon,this.props.params),i=a.couponId,s=a.offlineId,l=a.couponName,r=(this.textForSms.getValue(),this.selectedcounts.getSelectedOptions()),o=this.couponType.context;"0"===i||""===o?this.setState({isNotChecked:!0}):(this.setState({isSubmit:!0,isReset:!1,isSended:!0}),n((0,m.postSendCoupon)(s,i,r,l)))}},{key:"closeNotification",value:function(e){e.preventDefault(),this.setState({isErrorHappend:!1,isSuccess:!1,isEmpty:!1,isChecked:!1,isFailed:!1,isNotChecked:!1,isSubmit:!1,isReasonFailed:!1})}},{key:"closeAlert",value:function(e){e.preventDefault(),this.setState({isNotBind:!1})}},{key:"render",value:function(){var e=this,t=this.props.params,n=t.type,a=t.phone,i=t.realname,s=t.offlineId,l=(t.couponId,t.couponName),r=t.isBind,o=(t.sendCustomerCoupon,this.props),c=o.marketing,d=(o.error,c.reasons.pageItems),m=c.marketings.pageItems;return u.default.createElement(p.Container,{className:"ks-grid hm-marketing-container"},u.default.createElement(p.Notification,{title:"请稍后再来!",amStyle:"alert",visible:this.state.isErrorHappend,animated:!0,onDismiss:this.closeNotification},"服务器正在卖力处理中"),u.default.createElement(p.Notification,{title:"失败了!",amStyle:"alert",visible:this.state.isNotChecked,animated:!0,onDismiss:this.closeNotification},"未选择优惠券"),u.default.createElement(p.Notification,{title:"失败了!",amStyle:"alert",visible:this.state.isFailed,animated:!0,onDismiss:this.closeNotification},"发送失败"),u.default.createElement(p.Notification,{title:"成功了!",amStyle:"success",visible:this.state.isChecked,animated:!0,onDismiss:this.closeNotification},"发送成功"),u.default.createElement(p.Notification,{title:"成功了!",amStyle:"success",visible:this.state.isSuccess,animated:!0,onDismiss:this.closeNotification},"提交成功"),u.default.createElement(p.Notification,{title:"失败了!",amStyle:"alert",visible:this.state.isReasonFailed,animated:!0,onDismiss:this.closeNotification},"提交失败"),u.default.createElement(p.Notification,{title:"无法发送!",amStyle:"alert",visible:this.state.isNotBind,animated:!0,onDismiss:this.closeAlert},"该用户未绑定微信，无法发券"),u.default.createElement(f.If,{condition:"memberMarketing"===n},u.default.createElement("div",null,u.default.createElement(y.default,{title:"申请券发放",history:this.props.history}),u.default.createElement("main",{className:"hm-customer-vip-order-main"},u.default.createElement("ul",{className:"marketing-list"},u.default.createElement("li",null,u.default.createElement("p",{className:"label"},"营销会员"),u.default.createElement("span",null,""+i)),u.default.createElement("li",null,u.default.createElement("p",{className:"label"},"营销原因"),u.default.createElement(p.Field,{id:"hm_marketing_select",type:"select",ref:function(t){e.selectedReason=t}},d&&d.map(function(e,t){var n="reason-"+t;return u.default.createElement("option",{key:n,value:e.id},e.name)})))),u.default.createElement("div",{className:"replenish"},u.default.createElement("span",{className:"label"},"补充说明"),u.default.createElement("textarea",{type:"textarea",placeholder:"针对该营销手段的补充说明",ref:function(t){e.noteForMarketing=t}})),u.default.createElement(p.Button,{id:"hm_marketing_commit",block:!0,amStyle:"alert",onClick:this.handleCommitMarketing,disabled:this.state.isSubmit},"提交审核")),u.default.createElement(p.List,{className:"hm-market-list"},m&&m.map(function(e,t){var n="market-"+t,a="";switch(e.state){case"0":a="通过";break;case"1":a="不通过";break;case"2":a="审核中"}return u.default.createElement(p.List.Item,{key:n,title:e.reason,subTitle:""===e.remark?"未添加备注":e.remark,after:a})})))),u.default.createElement(f.If,{condition:"specifyMarketing"===n},u.default.createElement("div",null,u.default.createElement(y.default,{title:"已有券发放",history:this.props.history}),u.default.createElement("main",{className:"hm-customer-assign-order-main"},u.default.createElement("ul",{className:"marketing-list"},u.default.createElement("li",null,u.default.createElement("p",{className:"label"},"营销会员"),u.default.createElement("span",null,""+i)),u.default.createElement("li",null,u.default.createElement("a",{id:"hm_marketing_choose_coupon_link",href:"#/customer/coupon/list/"+r+"/"+a+"/"+s+"/"+i},u.default.createElement("p",{className:"label"},"选择优惠券"),u.default.createElement("p",null,this.state.isReset&&u.default.createElement("span",{ref:function(t){e.couponType=t}},l?"已选"+l:""),u.default.createElement(p.Icon,{name:"right-nav"})))),u.default.createElement("li",null,u.default.createElement("p",{className:"label"},"赠送数量"),u.default.createElement(p.Field,{id:"hm_marketing_coupon_coupon_choose_select",type:"select",ref:function(t){e.selectedcounts=t}},u.default.createElement("option",{value:"1"},"1张/人"),u.default.createElement("option",{value:"2"},"2张/人"),u.default.createElement("option",{value:"3"},"3张/人"),u.default.createElement("option",{value:"4"},"4张/人"),u.default.createElement("option",{value:"5"},"5张/人")))),u.default.createElement("div",{className:"replenish hide"},u.default.createElement("span",{className:"label"},"短信提醒内容"),u.default.createElement(p.Field,{type:"textarea",placeholder:"短信提醒内容",ref:function(t){e.textForSms=t}})),u.default.createElement(p.Button,{id:"hm_marketing_send_coupon_button",block:!0,amStyle:"alert",onClick:this.handleSpecifyMarketing,disabled:this.state.isSubmit},"发送")))))}}]),t}(c.Component);b.propTypes={dispatch:c.PropTypes.func,error:c.PropTypes.object,marketing:c.PropTypes.object,sendCustomerCoupon:c.PropTypes.object,sendCustomerMarketing:c.PropTypes.object,history:c.PropTypes.object},t.default=(0,d.connect)(r)(b)},946:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(2),o=function(e){return e&&e.__esModule?e:{default:e}}(r);n(401),n(954);var c=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n.handleBack=n.handleBack.bind(n),n.handleClick=n.handleClick.bind(n),n}return s(t,e),l(t,[{key:"handleBack",value:function(e){e.preventDefault(),this.props.history.goBack()}},{key:"handleClick",value:function(e){e.preventDefault(),this.props.openSearchInput()}},{key:"render",value:function(){var e=this.props,t=e.title,n=(e.history,e.other,e.type),a=e.mode,i=void 0;return i="normal"===n?o.default.createElement("div",{className:"normal"},t):"special"===n?o.default.createElement("div",{className:"special"},o.default.createElement("span",{id:"hm_back",href:"#/",className:"icon icon-left-nav",onClick:this.handleBack}),o.default.createElement("span",{className:"title"},t),o.default.createElement("span",{className:"other"},o.default.createElement("span",{className:"icon icon-search searchButton",onClick:this.handleClick}))):o.default.createElement("div",{className:"default"},o.default.createElement("span",{id:"hm_back",href:"#/",className:"icon icon-left-nav",onClick:this.handleBack}),o.default.createElement("span",{className:"default-title"},t)),o.default.createElement("header",{className:a?"hm-default-header manager":"hm-default-header"},i)}}]),t}(o.default.Component);t.default=c,c.propTypes={title:r.PropTypes.string.isRequired,history:r.PropTypes.object.isRequired,other:r.PropTypes.string.isRequired,type:r.PropTypes.string.isRequired,openSearchInput:r.PropTypes.func.isRequired,mode:r.PropTypes.string.isRequired}},954:function(e,t){}});